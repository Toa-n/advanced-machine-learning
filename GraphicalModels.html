<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
.markmap-dark {
  background: #27272a;
  color: white;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.12/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
              if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.documentElement.classList.add("markmap-dark");
              }
            })(() => window.markmap,null,{"content":"Graphical Models","children":[{"content":"Graphical Models","children":[{"content":"Introduction","children":[{"content":"<strong>Definition</strong>: A fusion of probability theory and graph theory to represent and analyze probabilistic models.","children":[],"payload":{"tag":"li","lines":"9,10"}},{"content":"<strong>Purpose</strong>:","children":[{"content":"To visualize the structure of a probabilistic model.","children":[],"payload":{"tag":"li","lines":"11,12"}},{"content":"To discover properties of the model, like conditional independence.","children":[],"payload":{"tag":"li","lines":"12,13"}},{"content":"To find efficient ways to compute probabilities (inference).","children":[],"payload":{"tag":"li","lines":"13,14"}}],"payload":{"tag":"li","lines":"10,14"}},{"content":"<strong>Key Idea</strong>: The graph structure (nodes and edges) defines the dependencies and independences between random variables. The <em>missing</em> edges are crucial as they represent simplifying assumptions.","children":[],"payload":{"tag":"li","lines":"14,16"}}],"payload":{"tag":"h2","lines":"8,9"}},{"content":"Key Components &amp; Types","children":[{"content":"<strong>Nodes</strong>: Represent random variables (can be discrete, continuous, binary).","children":[{"content":"Unobserved (unknown) nodes are usually empty circles.","children":[],"payload":{"tag":"li","lines":"18,19"}},{"content":"Observed (known) nodes are shaded circles.","children":[],"payload":{"tag":"li","lines":"19,20"}}],"payload":{"tag":"li","lines":"17,20"}},{"content":"<strong>Edges</strong>: Represent probabilistic relationships between variables.","children":[],"payload":{"tag":"li","lines":"20,21"}},{"content":"<strong>Two Main Types</strong>:","children":[{"content":"<strong>Directed Graphical Models (Bayesian Networks)</strong>: Edges have a direction, indicating a (causal) dependency.","children":[],"payload":{"tag":"li","lines":"22,23"}},{"content":"<strong>Undirected Graphical Models (Markov Random Fields)</strong>: Edges are undirected, representing general correlations.","children":[],"payload":{"tag":"li","lines":"23,25"}}],"payload":{"tag":"li","lines":"21,25"}}],"payload":{"tag":"h2","lines":"16,17"}}],"payload":{"tag":"h1","lines":"6,7"}},{"content":"Directed Graphical Models (Bayesian Networks)","children":[{"content":"Factorization &amp; Joint Probability","children":[{"content":"Example: Chain of Nodes (a -&gt; b -&gt; c)","children":[{"content":"<strong>Formula</strong>: <code>p(a, b, c) = p(c | b) * p(b | a) * p(a)</code>","children":[],"payload":{"tag":"li","lines":"38,40"}}],"payload":{"tag":"h3","lines":"37,38"}},{"content":"Example: Convergent Connection (a -&gt; c &lt;- b)","children":[{"content":"<strong>Formula</strong>: <code>p(a, b, c) = p(c | a, b) * p(a) * p(b)</code>","children":[],"payload":{"tag":"li","lines":"41,42"}},{"content":"<strong>Note</strong>: This assumes <code>a</code> and <code>b</code> are marginally independent.","children":[],"payload":{"tag":"li","lines":"42,44"}}],"payload":{"tag":"h3","lines":"40,41"}}],"payload":{"tag":"h2","lines":"28,29"}},{"content":"Conditional Independence","children":[{"content":"D-Separation (&quot;Directed Separation&quot;)","children":[{"content":"<strong>Problem</strong>: Determine if a set of nodes <code>A</code> is conditionally independent of a set <code>B</code> given a set <code>C</code>.","children":[],"payload":{"tag":"li","lines":"51,52"}},{"content":"<strong>Algorithm</strong>: A path from any node in <code>A</code> to any node in <code>B</code> is <strong>blocked</strong> if it contains a node <code>n</code> where:","children":[{"content":"1. The arrows on the path meet <strong>head-to-tail</strong> (<code>-&gt; n -&gt;</code>) or <strong>tail-to-tail</strong> (<code>&lt;- n -&gt;</code>) at <code>n</code>, AND <code>n</code> is in the conditioning set <code>C</code>.","children":[],"payload":{"tag":"li","lines":"53,54","listIndex":1}},{"content":"2. The arrows on the path meet <strong>head-to-head</strong> (<code>-&gt; n &lt;-</code>) at <code>n</code>, AND neither <code>n</code> nor any of its descendants are in the conditioning set <code>C</code>.","children":[],"payload":{"tag":"li","lines":"54,55","listIndex":2}}],"payload":{"tag":"li","lines":"52,55"}},{"content":"<strong>Conclusion</strong>: If all paths from <code>A</code> to <code>B</code> are blocked by <code>C</code>, then <code>A</code> is d-separated from <code>B</code> by <code>C</code>, which means <code>A &#x22a5; B | C</code>.","children":[],"payload":{"tag":"li","lines":"55,57"}}],"payload":{"tag":"h3","lines":"50,51"}},{"content":"Three Fundamental Cases for a Path (a - n - b)","children":[{"content":"1. <strong>Tail-to-Tail (Divergent)</strong>: <code>a &lt;- n -&gt; b</code>","children":[{"content":"<code>a</code> and <code>b</code> are <strong>NOT</strong> independent.","children":[],"payload":{"tag":"li","lines":"59,60"}},{"content":"They become <strong>conditionally independent</strong> if <code>n</code> is observed (i.e., given <code>n</code>).","children":[],"payload":{"tag":"li","lines":"60,61"}}],"payload":{"tag":"li","lines":"58,61","listIndex":1}},{"content":"2. <strong>Head-to-Tail (Chain)</strong>: <code>a -&gt; n -&gt; b</code>","children":[{"content":"<code>a</code> and <code>b</code> are <strong>NOT</strong> independent.","children":[],"payload":{"tag":"li","lines":"62,63"}},{"content":"They become <strong>conditionally independent</strong> if <code>n</code> is observed.","children":[],"payload":{"tag":"li","lines":"63,64"}}],"payload":{"tag":"li","lines":"61,64","listIndex":2}},{"content":"3. <strong>Head-to-Head (Convergent)</strong>: <code>a -&gt; n &lt;- b</code>","children":[{"content":"<code>a</code> and <code>b</code> <strong>ARE</strong> independent.","children":[],"payload":{"tag":"li","lines":"65,66"}},{"content":"They become <strong>conditionally dependent</strong> if <code>n</code> or any of its descendants are observed.","children":[],"payload":{"tag":"li","lines":"66,68"}}],"payload":{"tag":"li","lines":"64,68","listIndex":3}}],"payload":{"tag":"h3","lines":"57,58"}},{"content":"Explaining Away","children":[{"content":"A phenomenon specific to <strong>head-to-head</strong> connections.","children":[],"payload":{"tag":"li","lines":"69,70"}},{"content":"<strong>Intuition</strong>: If we observe a common effect (<code>n</code>), and one of its causes (<code>a</code>) is confirmed, our belief in the other cause (<code>b</code>) decreases. The confirmed cause &quot;explains away&quot; the effect.","children":[],"payload":{"tag":"li","lines":"70,72"}}],"payload":{"tag":"h3","lines":"68,69"}},{"content":"Bayes Ball Algorithm","children":[{"content":"<strong>An intuitive algorithm for determining d-separation.</strong>","children":[],"payload":{"tag":"li","lines":"73,74"}},{"content":"<strong>Algorithm</strong>: To test <code>X &#x22a5; Y | V</code>:","children":[{"content":"Place &quot;balls&quot; at each node in <code>X</code>. Let them travel according to rules, trying to reach <code>Y</code>.","children":[],"payload":{"tag":"li","lines":"75,76"}},{"content":"<strong>Rules (at a node W)</strong>:","children":[{"content":"<strong>Unobserved (W &#x2209; V)</strong>:","children":[{"content":"A ball from a parent passes through to all children.","children":[],"payload":{"tag":"li","lines":"78,79"}},{"content":"A ball from a child is bounced back to all parents and also passed through to all other children.","children":[],"payload":{"tag":"li","lines":"79,80"}}],"payload":{"tag":"li","lines":"77,80"}},{"content":"<strong>Observed (W &#x2208; V)</strong>:","children":[{"content":"A ball from a parent is bounced back to all parents.","children":[],"payload":{"tag":"li","lines":"81,82"}},{"content":"A ball from a child is blocked.","children":[],"payload":{"tag":"li","lines":"82,83"}}],"payload":{"tag":"li","lines":"80,83"}}],"payload":{"tag":"li","lines":"76,83"}}],"payload":{"tag":"li","lines":"74,83"}},{"content":"<strong>Conclusion</strong>: If no ball from <code>X</code> can reach <code>Y</code>, then <code>X &#x22a5; Y | V</code>.","children":[],"payload":{"tag":"li","lines":"83,85"}}],"payload":{"tag":"h3","lines":"72,73"}},{"content":"Markov Blanket","children":[{"content":"<strong>Definition</strong>: The minimal set of nodes that renders a node <code>x_i</code> conditionally independent of all other nodes in the graph.","children":[],"payload":{"tag":"li","lines":"86,87"}},{"content":"<strong>Composition</strong>: The Markov Blanket of <code>x_i</code> includes its:","children":[{"content":"<strong>Parents</strong>","children":[],"payload":{"tag":"li","lines":"88,89"}},{"content":"<strong>Children</strong>","children":[],"payload":{"tag":"li","lines":"89,90"}},{"content":"<strong>Co-parents</strong> (other parents of its children)","children":[],"payload":{"tag":"li","lines":"90,91"}}],"payload":{"tag":"li","lines":"87,91"}},{"content":"<strong>Note</strong>: The &quot;co-parents&quot; part is due to the explaining away phenomenon.","children":[],"payload":{"tag":"li","lines":"91,93"}}],"payload":{"tag":"h3","lines":"85,86"}}],"payload":{"tag":"h2","lines":"44,45"}}],"payload":{"tag":"h1","lines":"25,26"}},{"content":"Undirected Graphical Models (Markov Random Fields - MRFs)","children":[{"content":"Conditional Independence","children":[{"content":"<strong>Rule</strong>: Much simpler than in Bayesian Networks.","children":[],"payload":{"tag":"li","lines":"97,98"}},{"content":"<strong>Algorithm</strong>: Two sets of nodes <code>A</code> and <code>B</code> are conditionally independent given a set <code>C</code> if <strong>all paths</strong> from <code>A</code> to <code>B</code> pass through at least one node in <code>C</code>.","children":[],"payload":{"tag":"li","lines":"98,99"}},{"content":"<strong>Intuition</strong>: If <code>C</code> &quot;separates&quot; <code>A</code> from <code>B</code> in the graph, then <code>A &#x22a5; B | C</code>.","children":[],"payload":{"tag":"li","lines":"99,101"}}],"payload":{"tag":"h2","lines":"96,97"}},{"content":"Factorization","children":[{"content":"More complex than in Bayesian Networks. Relies on the concept of cliques.","children":[],"payload":{"tag":"li","lines":"102,103"}},{"content":"<strong>Clique</strong>: A subset of nodes where every two distinct nodes are connected by an edge.","children":[],"payload":{"tag":"li","lines":"103,104"}},{"content":"<strong>Maximal Clique</strong>: A clique that cannot be extended by adding any other node from the graph.","children":[],"payload":{"tag":"li","lines":"104,105"}},{"content":"<strong>Problem</strong>: Define the joint probability distribution.","children":[],"payload":{"tag":"li","lines":"105,106"}},{"content":"<strong>Formula</strong>: The joint distribution is a product of potential functions <code>&#x3c8;_C</code> over the maximal cliques <code>C</code> of the graph.","children":[{"content":"<code>p(x) = (1/Z) * &#x220f;_C &#x3c8;_C(x_C)</code>","children":[],"payload":{"tag":"li","lines":"107,108"}},{"content":"<strong>Potential Function <code>&#x3c8;_C(x_C)</code></strong>: A non-negative function measuring the &quot;compatibility&quot; or &quot;affinity&quot; of the variables in a clique.","children":[],"payload":{"tag":"li","lines":"108,109"}},{"content":"<strong>Partition Function <code>Z</code></strong>: A normalization constant to ensure the distribution sums/integrates to 1.","children":[{"content":"<code>Z = &#x3a3;_x &#x220f;_C &#x3c8;_C(x_C)</code>","children":[],"payload":{"tag":"li","lines":"110,111"}}],"payload":{"tag":"li","lines":"109,111"}}],"payload":{"tag":"li","lines":"106,111"}},{"content":"<strong>Boltzmann Distribution</strong>: A common way to define potential functions using an energy function <code>E</code>.","children":[{"content":"<code>&#x3c8;_C(x_C) = exp(-E(x_C))</code>","children":[],"payload":{"tag":"li","lines":"112,113"}}],"payload":{"tag":"li","lines":"111,113"}},{"content":"<strong>Notes</strong>:","children":[{"content":"The presence of the partition function <code>Z</code> is a major limitation, as it can be computationally expensive to calculate (requires summing over all possible states of <code>x</code>).","children":[],"payload":{"tag":"li","lines":"114,115"}},{"content":"Unlike BNs, MRFs are not automatically normalized.","children":[],"payload":{"tag":"li","lines":"115,117"}}],"payload":{"tag":"li","lines":"113,117"}}],"payload":{"tag":"h2","lines":"101,102"}},{"content":"Converting Directed to Undirected Graphs","children":[{"content":"<strong>Process</strong>: <strong>Moralization</strong>","children":[],"payload":{"tag":"li","lines":"118,119"}},{"content":"<strong>Algorithm</strong>:","children":[{"content":"1. <strong>Marry the parents</strong>: For each node, add an undirected edge between all pairs of its parents.","children":[],"payload":{"tag":"li","lines":"120,121","listIndex":1}},{"content":"2. <strong>Drop the arrows</strong>: Convert all original directed edges to undirected edges.","children":[],"payload":{"tag":"li","lines":"121,122","listIndex":2}},{"content":"3. The resulting graph is the <strong>moral graph</strong>.","children":[],"payload":{"tag":"li","lines":"122,123","listIndex":3}}],"payload":{"tag":"li","lines":"119,123"}},{"content":"<strong>Note</strong>: This process can lose conditional independence information that the original directed graph contained (e.g., the independence in a head-to-head structure is lost).","children":[],"payload":{"tag":"li","lines":"123,125"}}],"payload":{"tag":"h2","lines":"117,118"}}],"payload":{"tag":"h1","lines":"93,94"}},{"content":"Inference in Graphical Models","children":[{"content":"Exact Inference on a Chain","children":[{"content":"<strong>Problem</strong>: Compute the marginal probability <code>p(x_n)</code> for a node in a chain.","children":[],"payload":{"tag":"li","lines":"129,130"}},{"content":"<strong>Algorithm</strong>: <strong>Sum-Product (or Message Passing)</strong>. Avoids naively summing over all variables.","children":[{"content":"<strong>Intuition</strong>: Split the computation into two parts, passing &quot;messages&quot; from the ends of the chain towards the query node <code>x_n</code>.","children":[],"payload":{"tag":"li","lines":"131,132"}},{"content":"<strong>Forward message <code>&#x3bc;_&#x3b1;(x_n)</code></strong>: <code>&#x3bc;_&#x3b1;(x_n) = &#x3a3;_{x_{n-1}} &#x3c8;_{n-1,n}(x_{n-1}, x_n) * &#x3bc;_&#x3b1;(x_{n-1})</code>","children":[],"payload":{"tag":"li","lines":"132,133"}},{"content":"<strong>Backward message <code>&#x3bc;_&#x3b2;(x_n)</code></strong>: <code>&#x3bc;_&#x3b2;(x_n) = &#x3a3;_{x_{n+1}} &#x3c8;_{n,n+1}(x_n, x_{n+1}) * &#x3bc;_&#x3b2;(x_{n+1})</code>","children":[],"payload":{"tag":"li","lines":"133,134"}}],"payload":{"tag":"li","lines":"130,134"}},{"content":"<strong>Final Marginal</strong>: The marginal <code>p(x_n)</code> is the product of the incoming messages, normalized.","children":[{"content":"<code>p(x_n) = (1/Z) * &#x3bc;_&#x3b1;(x_n) * &#x3bc;_&#x3b2;(x_n)</code>","children":[],"payload":{"tag":"li","lines":"135,136"}}],"payload":{"tag":"li","lines":"134,136"}},{"content":"<strong>Normalization Constant <code>Z</code></strong>: Can be computed at any node <code>m</code> by summing the product of messages.","children":[{"content":"<code>Z = &#x3a3;_{x_m} &#x3bc;_&#x3b1;(x_m) * &#x3bc;_&#x3b2;(x_m)</code>","children":[],"payload":{"tag":"li","lines":"137,139"}}],"payload":{"tag":"li","lines":"136,139"}}],"payload":{"tag":"h2","lines":"128,129"}},{"content":"Exact Inference on a Tree","children":[{"content":"The message passing algorithm can be generalized to tree-structured graphs.","children":[],"payload":{"tag":"li","lines":"140,141"}},{"content":"<strong>Algorithm</strong>:","children":[{"content":"1. Designate the query node as the root of the tree.","children":[],"payload":{"tag":"li","lines":"142,143","listIndex":1}},{"content":"2. Messages are passed from the leaves up to the root.","children":[],"payload":{"tag":"li","lines":"143,144","listIndex":2}},{"content":"3. Messages are passed from the root back down to the leaves.","children":[],"payload":{"tag":"li","lines":"144,145","listIndex":3}},{"content":"4. Once all messages are computed, the marginal at any node can be calculated as the product of all incoming messages.","children":[],"payload":{"tag":"li","lines":"145,146","listIndex":4}}],"payload":{"tag":"li","lines":"141,146"}},{"content":"<strong>Note</strong>: The computational cost is linear in the number of nodes, making it very efficient for trees.","children":[],"payload":{"tag":"li","lines":"146,147"}}],"payload":{"tag":"h2","lines":"139,140"}}],"payload":{"tag":"h1","lines":"125,126"}}]},{"colorFreezeLevel":4,"initialExpandLevel":2})</script>
</body>
</html>
